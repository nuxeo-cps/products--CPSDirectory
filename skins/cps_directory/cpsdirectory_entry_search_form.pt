<tal:block define="
  global dirname request/dirname|string:members;
  global dir here/portal_directories/?dirname;
  validate python: request.has_key('cpsdirectory_search_button');
  res python: dir.renderSearchDetailed(request=request, validate=validate,
                                    callback='cpsdirectory_entry_search_do');
  global rendered_main python: res[0];
  global ok python: res[1];
  ds python: res[2];
  global portal_status_message python: (validate and not ok and 'psm_content_error') or '';
  "/>
<metal:block use-macro="here/main_template/macros/master">
  <metal:block fill-slot="header">
    <a tal:attributes="href string:${base_url}cpsdirectory_view">
      <img tal:replace="structure python:
        here.getImgTag('cpsdirectoryup_icon.gif', base_url=base_url)" />
      <b i18n:translate="">cpsdir_label_upto_directories</b></a>
    <div class="documentActions">
      <a tal:condition="python: dir.isCreateEntryAllowed()"
         tal:attributes="href
           string:${base_url}cpsdirectory_entry_create_form?dirname=$dirname"
         i18n:translate="">cpsdir_label_create_entry</a>
    </div>
    <h1>
      <span tal:condition="python:ok == 'results'"
        i18n:translate="">cpsdir_label_results</span>
      <span tal:condition="python:ok != 'results'"
        i18n:translate="">cpsdir_label_search</span> <tal:block i18n:translate=""
        tal:content="dirname" />
    </h1>
    <div class="description">
    </div>
  </metal:block>

  <metal:block fill-slot="css_slot">
    <link rel="Stylesheet" type="text/css" href=""
      tal:attributes="href string:${base_url}document.css">
  </metal:block>

  <metal:block fill-slot="main">
    <div tal:replace="structure rendered_main">Rendered main...</div>
  </metal:block>

</metal:block>
